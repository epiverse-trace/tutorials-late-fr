<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="fr" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Modélisation de scénarios des épidémies avec R: Tout sur une seule page</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/epiverse-trace/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/epiverse-trace/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/epiverse-trace/favicon-16x16.png">
<link rel="manifest" href="favicons/epiverse-trace/site.webmanifest">
<link rel="mask-icon" href="favicons/epiverse-trace/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav epiverse-trace"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Passer au contenu principal</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epiverse-trace-logo" alt="epiverse-trace" src="assets/images/epiverse-trace-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="Cette leçon est en version pre-alpha, ce qui signifie qu'elle est au début de son développement, mais n'a pas encore été enseignée.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">Cette leçon est en version pre-alpha, ce qui signifie qu'elle est au début de son développement, mais n'a pas encore été enseignée.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Changer de thème (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Vue Apprenti <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Vue Instructeur</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epiverse-trace" aria-label="Navigation Principale"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Afficher/cacher la barre de navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epiverse-trace" src="assets/images/epiverse-trace-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Modélisation de scénarios des épidémies avec R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Rechercher dans la page 'All In One'" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Modélisation de scénarios des épidémies avec R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Points clés</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossaire</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Profils d'apprentissage</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Voir plus <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="BF_measles.html">Introduction to Mathematical Modelling of Infectious Diseases</a></li>
<li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Rechercher dans la page 'All In One'"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Rechercher dans la page 'All In One'">Rechercher dans la page 'All In One'</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Modélisation de scénarios des épidémies avec R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress epiverse-trace">
    <div class="progress-bar epiverse-trace" role="progressbar" style="width: %" aria-valuenow="" aria-label="Avancée de la leçon" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="fermer le menu" alt="fermer le menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Cacher " data-episodes="Épisodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Vue Apprenti
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Vue Instructeur</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  ÉPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Résumé et Mise en Place</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="contact-matrices.html">1. Matrices de contact</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="simulating-transmission.html">2. Simulation de la transmission</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="modelling-interventions.html">3. Modélisation des interventions</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESSOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Points clés</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossaire</a>
                      </li>
                      <li>
                        <a href="profiles.html">Profils d'apprentissage</a>
                      </li>
                      <li><a href="BF_measles.html">Introduction to Mathematical Modelling of Infectious Diseases</a></li>
<li><a href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">Voir tout sur une seule page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-contact-matrices"><p>Content from <a href="contact-matrices.html">Matrices de contact</a></p>
<hr>
<p>Dernière mise à jour le 2025-11-11 |

        <a href="https://github.com/epiverse-trace/tutorials-late-fr/edit/main/episodes/contact-matrices.Rmd" class="external-link">Modifier cette page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Afficher toutes les solutions " data-collapse="Cacher toutes les solutions "> Afficher toutes les solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Vue d'ensemble</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Qu’est-ce qu’une matrice de contact ?</li>
<li>Comment les matrices de contact sont-elles estimées ?</li>
<li>Comment les matrices de contact sont-elles utilisées dans l’analyse
épidémiologique ?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectifs</h3>
<ul>
<li>Utilisez le package R <code>socialmixr</code> pour estimer une
matrice de contact</li>
<li>Comprendre les différents types d’analyse pour lesquels les matrices
de contact peuvent être utilisées</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Certains groupes d’individus ont plus de contacts que d’autres ;
l’écolier moyen a beaucoup plus de contacts quotidiens que la personne
âgée moyenne, par exemple. Cette hétérogénéité des schémas de contact
entre les différents groupes peut avoir un impact sur la transmission
des maladies, car certains groupes sont plus susceptibles de transmettre
la maladie à d’autres membres de ce groupe, ainsi qu’à d’autres groupes.
La vitesse à laquelle les individus d’un même groupe et d’un groupe à
l’autre entrent en contact avec d’autres personnes peut être résumée
dans une matrice de contact. Dans ce tutoriel, nous allons apprendre
comment les matrices de contact peuvent être utilisées dans différentes
analyses et comment le package <a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a> peut être
utilisé pour estimer les matrices de contact.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">socialmixr</span><span class="op">)</span></span></code></pre>
</div>

</section><section><h2 class="section-heading" id="la-matrice-de-contact">La matrice de contact<a class="anchor" aria-label="anchor" href="#la-matrice-de-contact"></a>
</h2>
<hr class="half-width">
<p>La matrice de contact de base représente la quantité de contacts, ou
de mélanges, au sein de différents sous-groupes d’une population et
entre ces sous-groupes. Les sous-groupes sont souvent des catégories
d’âge, mais peuvent aussi être.. :</p>
<ul>
<li>des zones géographiques (par exemple, différentes régions ou
différents pays)</li>
<li>Groupes à risque (par exemple, professions à haut/faible
risque)</li>
<li>Milieux sociaux (ménage, lieu de travail, école, etc.)</li>
</ul>
<p>Par exemple, une matrice de contact hypothétique représentant le
nombre moyen de contacts par jour entre les enfants et les adultes
pourrait être la suivante :</p>
<p><span class="math display">\[
\begin{bmatrix}
2 &amp; 2\
1 &amp; 3
\end{bmatrix}
\]</span> Dans cet exemple, cela signifie que les enfants rencontrent en
moyenne 2 autres enfants et 2 adultes par jour (première ligne), et que
les adultes rencontrent en moyenne 1 enfant et 3 autres adultes par jour
(deuxième ligne). Nous pouvons utiliser ce type d’information pour
rendre compte du rôle que joue l’hétérogénéité des contacts dans la
transmission des maladies infectieuses.</p>
<div id="note-sur-la-notation" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note-sur-la-notation" class="callout-inner">
<h3 class="callout-title">Note sur la notation</h3>
<div class="callout-content">
<p>Pour une matrice de contact avec des lignes <span class="math inline">\(i\)</span> et des colonnes <span class="math inline">\(j\)</span>:</p>
<ul>
<li>$C [i,j] $ représente le nombre moyen de contacts que les individus
du groupe <span class="math inline">\(i\)</span> ont avec les individus
du groupe <span class="math inline">\(j\)</span>
</li>
<li>Cette moyenne est calculée comme le nombre total de contacts entre
les groupes. <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>, divisé par le nombre d’individus dans
le groupe <span class="math inline">\(i\)</span>
</li>
</ul>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="lutilisation-socialmixr">L’utilisation <code>socialmixr</code>
<a class="anchor" aria-label="anchor" href="#lutilisation-socialmixr"></a>
</h2>
<hr class="half-width">
<p>Les matrices de contact sont généralement estimées à partir des
études qui utilisent des journaux pour enregistrer les interactions. Par
exemple, l’enquête POLYMOD a mesuré les schémas de contact dans 8 pays
européens en utilisant des données sur le lieu et la durée des contacts
signalés par les participants à l’étude. <a href="https://doi.org/10.1371/journal.pmed.0050074" class="external-link">(Mossong et
al. 2008)</a>.</p>
<p>Le package R <a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a> contient des fonctions
permettant d’estimer les matrices de contact à partir de POLYMOD et
d’autres enquêtes. Nous pouvons charger les données de l’enquête POLYMOD
:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polymod</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="va">polymod</span></span></code></pre>
</div>
<p>Nous pouvons alors obtenir la matrice de contact pour les catégories
d’âge souhaitées en spécifiant <code>age.limits</code>.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contact_data</span> <span class="op">&lt;-</span> <span class="fu">contact_matrix</span><span class="op">(</span></span>
<span>  survey <span class="op">=</span> <span class="va">polymod</span>,</span>
<span>  countries <span class="op">=</span> <span class="st">"United Kingdom"</span>,</span>
<span>  age.limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  symmetric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Removing participants that have contacts without age information. To change this behaviour, set the 'missing.contact.age' option</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contact_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$matrix
         contact.age.group
age.group   [0,20)  [20,40)      40+
  [0,20)  7.883663 3.120220 3.063895
  [20,40) 2.794154 4.854839 4.599893
  40+     1.565665 2.624868 5.005571

$demography
   age.group population proportion  year
      &lt;char&gt;      &lt;num&gt;      &lt;num&gt; &lt;int&gt;
1:    [0,20)   14799290  0.2454816  2005
2:   [20,40)   16526302  0.2741283  2005
3:       40+   28961159  0.4803901  2005

$participants
   age.group participants proportion
      &lt;char&gt;        &lt;int&gt;      &lt;num&gt;
1:    [0,20)          404  0.3996044
2:   [20,40)          248  0.2453017
3:       40+          359  0.3550940</code></pre>
</div>
<p><strong>Remarque : bien que la matrice de contact
<code>contact_data$matrix</code> ne soit pas elle-même mathématiquement
symétrique, elle satisfait à la condition selon laquelle le nombre total
de contacts d’un groupe avec un autre est le même que l’inverse. En
d’autres termes :
<code>contact_data$matrix[j,i]*contact_data$demography$proportion[j] = contact_data$matrix[i,j]*contact_data$demography$proportion[i]</code>.
Pour l’explication mathématique, voir <a href="https://epiforecasts.io/socialmixr/articles/socialmixr.html#symmetric-contact-matrices" class="external-link">la
section correspondante dans la documentation de
socialmixr</a>.</strong></p>
<div id="pourquoi-une-matrice-de-contact-serait-elle-non-symétrique" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="pourquoi-une-matrice-de-contact-serait-elle-non-symétrique" class="callout-inner">
<h3 class="callout-title">Pourquoi une matrice de contact serait-elle non symétrique ?</h3>
<div class="callout-content">
<p>L’un des arguments que nous avons donné à la fonction
<code>contact_matrix()</code> est <code>symmetric=TRUE</code>. Cela
garantit que le nombre total de contacts d’un groupe à l’autre est égal
au nombre total de contacts du second groupe au premier (voir la section
<code>socialmixr</code> <a href="https://cran.r-project.org/web/packages/socialmixr/vignettes/socialmixr.html" class="external-link">vignette</a>
pour plus de détails).</p>
<p>Cependant, lorsque les matrices de contact sont estimées à partir
d’enquêtes ou d’autres sources, le nombre de contacts <em>signalés</em>
peut différer selon le groupe d’âge pour plusieurs raisons :</p>
<ul>
<li>Biais de mémorisation : Les différents groupes d’âge pourraient
avoir des capacités différentes à se souvenir des contacts et à les
décrire avec précision.</li>
<li>Biais de déclaration : certains groupes pourraient systématiquement
surestimer ou sous-estimer leurs contacts.</li>
<li>Incertitude de l’échantillonnage : La taille limitée des
échantillons pourrait entraîner des variations statistiques <a href="https://doi.org/10.1371/journal.pcbi.1009098" class="external-link">(Prem et al
2021)</a>
</li>
</ul>
<p>Si <code>symmetric</code> est réglé sur VRAI, la fonction
<code>contact_matrix()</code> utilisera une moyenne des contacts
signalés pour s’assurer que le nombre total de contacts obtenu est
symétrique.</p>
</div>
</div>
</div>
<p>L’exemple ci-dessus utilise l’enquête POLYMOD. Il existe un certain
nombre d’enquêtes disponibles dans <code>socialmixr</code> Pour obtenir
la liste des enquêtes disponibles, utilisez <code>list_surveys()</code>.
Pour télécharger une enquête, vous pouvez utiliser
<code>get_survey()</code></p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zambia_sa_survey</span> <span class="op">&lt;-</span> <span class="fu">get_survey</span><span class="op">(</span></span>
<span>  <span class="st">"https://doi.org/10.5281/zenodo.3874675"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Afficher les détails </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Vous pouvez explorer toutes les enquêtes disponibles dans le
référentiel Zenodo à l’adresse <a href="https://zenodo.org/communities/social_contact_data/" class="external-link uri">https://zenodo.org/communities/social_contact_data/</a>. Si
vous souhaitez accéder à une URL spécifique dans R, vous pouvez essayer
:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">socialmixr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get URL for Zambia contact survey data from {socialmixr}</span></span>
<span><span class="fu">socialmixr</span><span class="fu">::</span><span class="fu">list_surveys</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">title</span>, <span class="st">"Zambia"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">pull</span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="matrice-des-contacts-en-zambie" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="matrice-des-contacts-en-zambie" class="callout-inner">
<h3 class="callout-title">Matrice des contacts en Zambie</h3>
<div class="callout-content">
<p>Le package R {socialmixr} contient des fonctions permettant d’estimer
les matrices de contacts à partir de POLYMOD et d’autres enquêtes. Les
résultats comprennent des informations démographiques telles que la
taille de la population et le nombre de participants à l’étude. En
utilisant {socialmixr}:</p>
<ul>
<li><p>Téléchargé l’enquête de la Zambie</p></li>
<li>
<p>Générez une matrice de contact symétrique pour la Zambie en
utilisant les tranches d’âge suivantes :</p>
<ul>
<li>[0,20)</li>
<li>20+</li>
</ul>
</li>
<li><p>Accédez au vecteur représentant la taille de la population par
tranche d’âge à partir du tableau de données démographiques dans la
matrice de contact.</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Donner un indice </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>L’objet d’enquête <code>zambia_sa_survey</code> contient des données
provenant de deux pays. Si vous avez besoin d’estimer la matrice des
contacts sociaux à partir des données spécifiques à la Zambie,
identifiez l’argument dont vous avez besoin dans
<code>socialmixr::contact_matrix()</code> pour cela.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inspect the countries within the survey object</span></span>
<span><span class="fu">levels</span><span class="op">(</span><span class="va">zambia_sa_survey</span><span class="op">$</span><span class="va">participants</span><span class="op">$</span><span class="va">country</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "South Africa" "Zambia"      </code></pre>
</div>
<p>Comme dans le code ci-dessus, pour accéder aux valeurs vectorielles
dans un dataframe, vous pouvez utiliser l’opérateur signe dollar :
<code>$</code></p>
</div>
</div>
</div>
</div>

<div id="matrices-de-contact-synthétiques" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="matrices-de-contact-synthétiques" class="callout-inner">
<h3 class="callout-title">Matrices de contact synthétiques</h3>
<div class="callout-content">
<p>Les matrices de contact peuvent être estimées à partir de données
obtenues des journaux (tels que POLYMOD), d’enquêtes ou de données de
contact. <a href="https://doi.org/10.1371/journal.pcbi.1009098" class="external-link">Prem et
al. 2021</a> ont utilisé les données POLYMOD dans le cadre d’un modèle
hiérarchique bayésien pour projeter les matrices de contact de 177
autres pays.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="analyses-avec-des-matrices-de-contact">Analyses avec des matrices de contact<a class="anchor" aria-label="anchor" href="#analyses-avec-des-matrices-de-contact"></a>
</h2>
<hr class="half-width">
<p>On peut utiliser les matrices de contact pour effectuer de nombreuses
analyses épidémiologiques différentes :</p>
<ul>
<li>pour calculer le nombre de reproduction de base tout en tenant
compte des différents taux de contacts entre les groupes d’âge <a href="https://doi.org/10.1186/s12916-019-1413-7" class="external-link">(Funk et
al. 2019)</a>,</li>
<li>pour calculer la taille finale d’une épidémie, comme dans le package
R <a href="https://github.com/epiverse-trace/finalsize" class="external-link">finalsize</a>,</li>
<li>pour évaluer l’impact des interventions en déterminant le changement
relatif entre les matrices de contact avant et après l’intervention pour
calculer la différence relative dans le nombre de cas. <span class="math inline">\(R_0\)</span> <a href="https://doi.org/10.1186/s12916-020-01597-8" class="external-link">(Jarvis et
al. 2020)</a>,</li>
<li>et dans les modèles mathématiques de transmission au sein d’une
population, afin de tenir compte des schémas de contact propres à chaque
groupe.</li>
</ul>
<p>Cependant, toutes ces applications nous obligent à effectuer des
calculs supplémentaires à l’aide de la matrice de contact. Plus
précisément, nous devons souvent effectuer deux calculs principaux :</p>
<ol style="list-style-type: decimal">
<li><strong>Convertir la matrice de contact en nombre attendu de cas
secondaires</strong></li>
</ol>
<p>Si les contacts varient entre les groupes, le nombre moyen de cas
secondaires ne sera pas simplement égal au nombre moyen de contacts
multiplié par la probabilité de transmission par contact. En effet, la
quantité moyenne de transmission dans chaque génération d’infection ne
dépend pas seulement des personnes avec lesquelles un groupe est entré
en contact, mais aussi des personnes avec lesquelles ces contacts sont
ensuite entrés en contact. La fonction <code>r_eff</code> dans le
package <a href="https://github.com/epiverse-trace/finalsize" class="external-link">finalsize</a> peut effectuer cette conversion, en
prenant une matrice de contact, la démographie et la proportion de
personnes sensibles et en la convertissant en une estimation du nombre
moyen de cas secondaires générés par un individu infectieux typique
(c’est-à-dire le nombre de reproduction effectif).</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Convertir la matrice des contacts en taux de
contact</strong></li>
</ol>
<p>Alors qu’une matrice de contacts donne le nombre moyen de contacts
qu’un groupe a avec un autre, la dynamique épidémique dans différents
groupes dépend du taux auquel un groupe en infecte un autre. Nous devons
donc mettre à l’échelle le taux d’interaction entre les différents
groupes (c’est-à-dire le nombre de contacts par unité de temps) pour
obtenir le taux de transmission. Cependant, nous devons veiller à
définir correctement la transmission vers et depuis chaque groupe dans
n’importe quel modèle. Plus précisément, l’entrée <span class="math inline">\((i,j)\)</span> dans la matrice des contacts d’un
modèle mathématique représente les contacts du groupe <span class="math inline">\(i\)</span> avec le groupe <span class="math inline">\(j\)</span>. Mais si nous voulons connaître le taux
auquel un groupe <span class="math inline">\(i\)</span> est infecté,
nous devons multiplier le nombre de contacts des personnes sensibles
dans le groupe <span class="math inline">\(i\)</span> (<span class="math inline">\(S_i\)</span>) avec le groupe <span class="math inline">\(j\)</span> ( $C [i,j] <span class="math inline">\() avec la proportion de ces contacts qui sont
infectieux (\)</span>I_j/N_j<span class="math inline">\() et le risque
de transmission par contact (\)</span>$).</p>
<div class="section level3">
<h3 id="dans-les-modèles-mathématiques">Dans les modèles mathématiques<a class="anchor" aria-label="anchor" href="#dans-les-mod%C3%A8les-math%C3%A9matiques"></a>
</h3>
<p>Considérons le modèle SIR dans lequel les individus sont catégorisés
comme étant soit sensibles <span class="math inline">\(S\)</span>,
infectés mais pas encore infectieux <span class="math inline">\(E\)</span>, contagieux <span class="math inline">\(I\)</span>, ou guéri <span class="math inline">\(R\)</span>. Le schéma ci-dessous montre les
processus qui décrivent le flux d’individus entre les différents états
<span class="math inline">\(S\)</span>, <span class="math inline">\(I\)</span> et <span class="math inline">\(R\)</span> et les paramètres clés de chaque
processus.</p>
<figure><img src="fig/contact-matrices-rendered-diagram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Les <a href="reference.html#ordinary">équations différentielles</a>
ci-dessous décrivent comment les individus passent d’un état à un autre
<a href="https://doi.org/10.1038/s41592-020-0822-z" class="external-link">(Bjørnstad et
al. 2020)</a>.</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS}{dt} &amp; = - \beta S I /N \
\frac{dI}{dt} &amp;= \beta S I /N - \gamma I \
\frac{dR}{dt} &amp;=\gamma I \
\end{aligned}
\]</span> Pour ajouter une structure d’âge à notre modèle, nous devons
ajouter des équations supplémentaires pour les états d’infection <span class="math inline">\(S\)</span>, <span class="math inline">\(I\)</span>
et <span class="math inline">\(R\)</span> pour chaque groupe d’âge <span class="math inline">\(i\)</span>. Si nous voulons supposer qu’il existe
une hétérogénéité dans les contacts entre les groupes d’âge, nous devons
adapter le terme de transmission <span class="math inline">\(\beta
SI\)</span> pour inclure la matrice de contact <span class="math inline">\(C\)</span> comme suit :</p>
<p><span class="math display">\[ \beta S_i \sum_j C_{i,j} I_j/N_j.
\]</span></p>
<p>Individus susceptibles dans le groupe d’âge <span class="math inline">\(i\)</span> sont infectés en fonction de leur taux
de contact avec les individus de chaque groupe d’âge. Pour chaque état
(<span class="math inline">\(S\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(I\)</span>
et <span class="math inline">\(R\)</span>) et le groupe d’âge (<span class="math inline">\(i\)</span>), nous avons une équation
différentielle décrivant le taux de changement par rapport au temps.</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS_i}{dt} &amp; = - \beta S_i \sum_j C_{i,j} I_j/N_j \
\frac{dI_i}{dt} &amp;= \beta S_i\sum_j C_{i,j} I_j/N_j - \gamma I_i \
\frac{dR_i}{dt} &amp;=\gamma I_i \
\end{aligned}
\]</span></p>
</div>
<div class="section level3">
<h3 id="la-normalisation-de-la-matrice-des-contacts-pour-garantir-la-valeur-correcte-de-r_0">La normalisation de la matrice des contacts pour garantir la valeur
correcte de <span class="math inline">\(R_0\)</span>
<a class="anchor" aria-label="anchor" href="#la-normalisation-de-la-matrice-des-contacts-pour-garantir-la-valeur-correcte-de-r_0"></a>
</h3>
<p>Lors de la simulation d’une épidémie, nous voulons souvent nous
assurer que le nombre moyen de cas secondaires générés par un individu
infectieux typique (c’est-à-dire <span class="math inline">\(R_0\)</span>) soit cohérent avec les valeurs
connues pour le pathogène que nous analysons. Dans le modèle ci-dessus,
nous mettons à l’échelle la matrice des contacts par le facteur <span class="math inline">\(\beta\)</span> pour convertir les données brutes
d’interaction en taux de transmission. Mais comment définir la valeur de
<span class="math inline">\(\beta\)</span> pour garantir une certaine
valeur de <span class="math inline">\(R_0\)</span>?</p>
<p>Plutôt que d’utiliser le nombre brut de contacts, nous pouvons
normaliser la matrice des contacts afin de faciliter le travail en
termes de <span class="math inline">\(R_0\)</span>. En particulier, nous
normalisons la matrice en la mettant à l’échelle de sorte que si nous
devions calculer le nombre moyen de cas secondaires sur la base de cette
matrice normalisée, le résultat serait 1 (en termes mathématiques, nous
mettons la matrice à l’échelle de sorte que la plus grande valeur propre
soit 1). Cette transformation met à l’échelle les entrées mais préserve
leurs valeurs relatives.</p>
<p>Dans le cas du modèle ci-dessus, nous voulons définir <span class="math inline">\(\beta  C_{i,j}\)</span> afin que le modèle ait une
valeur spécifiée de <span class="math inline">\(R_0\)</span>. Si
l’entrée de la matrice de contact $C [i,j] $ représente les contacts de
la population <span class="math inline">\(i\)</span> avec <span class="math inline">\(j\)</span>, il est équivalent à
<code>contact_data$matrix[i,j]</code> et la valeur propre maximale de
cette matrice représente l’ampleur typique des contacts, et non
l’ampleur typique de la transmission. Nous devons donc normaliser la
matrice <span class="math inline">\(C\)</span> de manière à ce que la
valeur propre maximale soit égale à un ; nous appelons cette matrice
<span class="math inline">\(C_{normalised}\)</span>. Comme le taux de
récupération est <span class="math inline">\(\gamma\)</span>, les
individus seront infectieux en moyenne pendant <span class="math inline">\(1/\gamma\)</span> jours. Ainsi, <span class="math inline">\(\beta\)</span> en tant qu’entrée du modèle est
calculée à partir de <span class="math inline">\(R_0\)</span>, le
facteur d’échelle, et la valeur de <span class="math inline">\(\gamma\)</span> (c’est-à-dire que,
mathématiquement, nous utilisons le fait que la valeur propre dominante
de la matrice <span class="math inline">\(R_0 \times
C_{normalised}\)</span> est égale à <span class="math inline">\(\beta /
\gamma\)</span>).</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="fu">t</span><span class="op">(</span><span class="va">contact_data</span><span class="op">$</span><span class="va">matrix</span><span class="op">)</span></span>
<span><span class="va">scaling_factor</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu">max</span><span class="op">(</span><span class="fu">eigen</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="va">normalised_matrix</span> <span class="op">&lt;-</span> <span class="va">contact_matrix</span> <span class="op">*</span> <span class="va">scaling_factor</span></span></code></pre>
</div>
<p>Par conséquent, si nous multiplions la matrice mise à l’échelle par
<span class="math inline">\(R_0\)</span> puis la multiplions en nombre
de cas secondaires attendus, nous obtenons <span class="math inline">\(R_0\)</span>, comme requis.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infectious_period</span> <span class="op">&lt;-</span> <span class="fl">7.0</span></span>
<span><span class="va">basic_reproduction</span> <span class="op">&lt;-</span> <span class="fl">1.46</span></span>
<span><span class="va">transmission_rate</span> <span class="op">&lt;-</span> <span class="va">basic_reproduction</span> <span class="op">*</span> <span class="va">scaling_factor</span> <span class="op">/</span> <span class="va">infectious_period</span></span>
<span><span class="co"># check the dominant eigenvalue of R0 x C_normalised is R0</span></span>
<span><span class="fu">max</span><span class="op">(</span><span class="fu">eigen</span><span class="op">(</span><span class="va">basic_reproduction</span> <span class="op">*</span> <span class="va">normalised_matrix</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.46</code></pre>
</div>
<div id="normalisation-à-laide-de-socialmixr" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="normalisation-à-laide-de-socialmixr" class="callout-inner">
<h3 class="callout-title">Normalisation à l’aide de
<code>socialmixr</code>
</h3>
<div class="callout-content">
<p>La normalisation peut être effectuée par la fonction
<code>contact_matrix()</code> dans <a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a>. Pour
obtenir la matrice normalisée, nous devons spécifier que nous voulons
séparer les différentes composantes de la matrice de contact à l’aide de
l’argument <code>split = TRUE</code>. Nous pouvons alors obtenir la
matrice normalisée de la manière suivante :</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contact_data_split</span> <span class="op">&lt;-</span> <span class="fu">contact_matrix</span><span class="op">(</span></span>
<span>  survey <span class="op">=</span> <span class="va">polymod</span>,</span>
<span>  countries <span class="op">=</span> <span class="st">"United Kingdom"</span>,</span>
<span>  age.limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  symmetric <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  split <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extraire les composants de la matrice de contact</span></span>
<span><span class="va">contacts_d</span> <span class="op">&lt;-</span> <span class="va">contact_data_split</span><span class="op">$</span><span class="va">contacts</span></span>
<span><span class="va">matrix_a</span> <span class="op">&lt;-</span> <span class="va">contact_data_split</span><span class="op">$</span><span class="va">matrix</span></span>
<span><span class="va">demography_n</span> <span class="op">&lt;-</span> <span class="va">contact_data_split</span><span class="op">$</span><span class="va">demography</span><span class="op">$</span><span class="va">proportion</span></span>
<span></span>
<span><span class="co"># calculer la matrice normalisée</span></span>
<span><span class="va">normalised_matrix_split</span> <span class="op">&lt;-</span> <span class="va">contacts_d</span> <span class="op">*</span> <span class="va">matrix_a</span> <span class="op">*</span> <span class="va">demography_n</span></span></code></pre>
</div>
<p>Pour plus de détails sur les différentes composantes de la matrice de
contact, voir <a href="https://cran.r-project.org/web/packages/socialmixr/vignettes/socialmixr.html#splitting-contact-matrices" class="external-link">la
vignette du package sur la division des matrices de contact.</a></p>
</div>
</div>
</div>
<div id="vérifiez-la-dimension-de-beta" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="vérifiez-la-dimension-de-beta" class="callout-inner">
<h3 class="callout-title">Vérifiez la dimension de <span class="math inline">\(\beta\)</span>
</h3>
<div class="callout-content">
<p>Dans le modèle SIR sans structure d’âge, le taux de contact fait
partie du taux de transmission. <span class="math inline">\(\beta\)</span> alors que dans le modèle avec
structure d’âge, nous avons séparé le taux de contact, et donc le taux
de transmission. Pour cette raison, <span class="math inline">\(\beta\)</span> dans le modèle structuré par âge
aura une valeur différente.</p>
</div>
</div>
</div>
<p>Nous pouvons utiliser les matrices de contact de
<code>socialmixr</code> avec des modèles mathématiques dans le package R
<code>{epidemics}</code>. Regarder le tutoriel <a href="simulating-transmission.html">Simuler la transmission</a> pour des
exemples et une introduction à <code>epidemics</code>.</p>
</div>
<div class="section level3">
<h3 id="groupes-de-contact">Groupes de contact<a class="anchor" aria-label="anchor" href="#groupes-de-contact"></a>
</h3>
<p>Dans l’exemple ci-dessus, la dimension de la matrice de contact sera
la même que le nombre de groupes d’âge, c’est-à-dire que s’il y a 3
groupes d’âge, la matrice de contact aura 3 lignes et 3 colonnes. Les
matrices de contact peuvent être utilisées pour d’autres groupes, à
condition que la dimension de la matrice corresponde au nombre de
groupes.</p>
<p>Par exemple, nous pourrions avoir un méta-modèle de population avec
deux zones géographiques. Notre matrice de contact serait alors une
matrice 2 x 2 dont les entrées représenteraient les contacts entre les
zones géographiques et à l’intérieur de celles-ci.</p>
</div>
</section><section><h2 class="section-heading" id="résumé">Résumé<a class="anchor" aria-label="anchor" href="#r%C3%A9sum%C3%A9"></a>
</h2>
<hr class="half-width">
<p>Dans ce tutoriel, nous avons appris la définition de la matrice de
contact, comment elle est estimée et comment accéder aux données de
contact social à partir de <code>socialmixr</code>. Dans le prochain
tutoriel, nous apprendrons à utiliser le package R
<code>{epidemics}</code> pour générer des trajectoires de maladies à
partir de modèles mathématiques avec des matrices de contact provenant
de <code>socialmixr</code>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Points clés</h3>
<div class="callout-content">
<ul>
<li>Les matrices de contact quantifient les schémas de mélange entre
différents groupes de population.</li>
<li>
<code>socialmixr</code> fournit des outils pour estimer les matrices
de contact à partir de données d’enquête</li>
<li>Les matrices de contact peuvent être utilisées dans diverses
analyses épidémiologiques, qu’il s’agisse du du calcul de <span class="math inline">\(R_0\)</span> à la modélisation des
interventions.</li>
<li>Une normalisation adéquate est cruciale lors de l’utilisation des
matrices de contact dans les modèles de transmission.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-simulating-transmission"><p>Content from <a href="simulating-transmission.html">Simulation de la transmission</a></p>
<hr>
<p>Dernière mise à jour le 2025-11-20 |

        <a href="https://github.com/epiverse-trace/tutorials-late-fr/edit/main/episodes/simulating-transmission.Rmd" class="external-link">Modifier cette page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Afficher toutes les solutions " data-collapse="Cacher toutes les solutions "> Afficher toutes les solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Vue d'ensemble</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Comment simuler la propagation d’une maladie à l’aide d’un modèle
mathématique ?</li>
<li>Quels sont les données nécessaires à la simulation d’un modèle
?</li>
<li>Comment tenir compte de l’incertitude ?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectifs</h3>
<ul>
<li>Chargez une structure de modèle existante à partir de la librairie
<code>{epidemics}</code>
</li>
<li>Chargez une matrice de contacts sociaux existante avec
<a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a>
</li>
<li>Générer une simulation de modèle de propagation d’une maladie avec
<code>{epidemics}</code>
</li>
<li>Générer des simulations de plusieurs modèles et visualiser
l’incertitude</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Pré-requis</h3>
<div class="callout-content">
<ul>
<li>Compléter le tutoriel sur <a href="contact-matrices.html">Matrices
de contact</a>.</li>
</ul>
<p>Les apprenants doivent se familiariser avec les concepts suivants
pour mieux comprendre les notions abordées dans ce cours.</p>
<p><strong>Modélisation mathématique</strong> : <a href="https://doi.org/10.1038/s41592-020-0856-2" class="external-link">Introduction aux
modèles de maladies infectieuses</a>, <a href="reference.html#state">variables d’état</a>, <a href="reference.html#parsode">paramètres du modèle</a>, <a href="reference.html#initial">conditions initiales</a>, <a href="reference.html#ordinary">équations différentielles</a>.</p>
<p><strong>Théorie des épidémies</strong> : <a href="https://doi.org/10.1155/2011/267049" class="external-link">Transmission</a>, <a href="https://doi.org/10.3201/eid2501.171901" class="external-link">Nombre de
reproduction</a>.</p>
<p><strong>R packages installés</strong>: <code>{epidemics}</code>,
<a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a>, <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a>.</p>
</div>
</div>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Afficher les détails </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Installer les packages si elles ne le sont pas déjà:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">base</span><span class="fu">::</span><span class="kw">require</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu">pak</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"epiverse-trace/epidemics"</span>, <span class="st">"socialmixr"</span>, <span class="st">"scales"</span>, <span class="st">"tidyverse"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Si vous recevez un message d’erreur, rendez-vous sur la <a href="index.html#configuration-des-logiciels">page principale de
configuration</a>.</p>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Les modèles mathématiques sont des outils essentiels pour générer des
trajectoires futures de propagation de maladies. a librairie
<code>{epidemics}</code> de R contient des fonctionnalités que nous
allons utiliser dans ce tutoriel pour générer des trajectoires de
maladie d’une souche de grippe à potentiel pandémique. À la fin de ce
tutoriel, vous serez en mesure de générer les trajectoires illustrées
ci-dessous, montrant le nombre d’individus infectieux dans différentes
catégories d’âge au cours du temps.</p>
<p>Dans les sections qui vont suivrent, nous allons apprendre à utiliser
la librairie <code>{epidemics}</code> pour simuler des trajectoires
d’une maladie et à accéder aux données de contacts sociaux à travers le
package <a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a>. Nous utiliserons
<a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a>, <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> et l’opérateur pipe
(<code>%&gt;%</code>) de la librairie <a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a> pour
relier certaines de leurs fonctions. Ainsi, nous chargerons la librairie
<a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> qui contient l’ensemble de ces trois
packages.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epidemics</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">socialmixr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>

</section><section><h2 class="section-heading" id="simuler-la-propagation-dune-maladie">Simuler la propagation d’une maladie<a class="anchor" aria-label="anchor" href="#simuler-la-propagation-dune-maladie"></a>
</h2>
<hr class="half-width">
<p>Pour simuler les trajectoires des maladies infectieuses, il faut
d’abord <strong>choisir un modèle mathématique</strong>. La librairie
<code>{epidemics}</code> contient une bibliothèque de modèles parmi
lesquels vous pouvez choisir celui qui conviendrai à la maladie
d’intéret. Les noms de ces modèles commencent par <code>model_*</code>
et se terminent par le nom de la maladie (par exemple
<code>model_ebola</code> pour Ebola) ou d’un identifiant différent (par
exemple <code>model_default</code>).</p>
<p>Dans ce tutoriel, nous utiliserons le modèle par défaut appelé
<code>model_default()</code> de la librairie <code>{epidemics}</code>.
Il s’agit d’un modèle structuré par âge qui classe les individus en
fonction de leur statut infectieux. Dans chaque groupe d’âge <span class="math inline">\(i\)</span> les individus sont classés dans les
compartiments suivants: sensibles <span class="math inline">\(S\)</span>, infectés mais pas encore contagieux
<span class="math inline">\(E\)</span>, infectieux <span class="math inline">\(I\)</span> et guéris <span class="math inline">\(R\)</span>. Nous devons ensuite définir le
processus par lequel les individus passent d’un compartiment à l’autre.
Cela peut se faire en définissant un ensemble d’ <a href="reference.html#ordinary">équations différentielles</a> qui
spécifient comment le nombre d’individus dans chaque compartiment évolue
dans le temps.</p>
<p>Le schéma ci-dessous montre les processus qui décrivent le flux
d’individus entre les états pathologiques <span class="math inline">\(S\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(I\)</span>
et <span class="math inline">\(R\)</span> et les paramètres clés de
chaque processus.</p>
<figure><img src="fig/simulating-transmission-rendered-diagram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="paramètres-du-modèle-les-taux" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="paramètres-du-modèle-les-taux" class="callout-inner">
<h3 class="callout-title">Paramètres du modèle : les taux</h3>
<div class="callout-content">
<p>Dans les modèles au niveau de la population définis par des équations
différentielles, les paramètres du modèle sont souvent (mais pas
toujours) spécifiés sous forme de taux. Le taux auquel un événement se
produit est l’inverse du temps moyen jusqu’à cet événement. Par exemple,
dans le modèle SEIR, le taux de guérrison <span class="math inline">\(\gamma\)</span> est l’inverse de la période
infectieuse moyenne.</p>
<p>Les valeurs de ces taux peuvent être déterminées à partir de
l’histoire naturelle de la maladie. Par exemple, si les personnes sont
en moyenne infectieuses pendant 8 jours, alors dans le modèle, une
personnes sur huits (1/8) actuellement infectieuses se rétablissent
chaque jour (c’est-à-dire le taux de guèrrison <span class="math inline">\(\gamma=1/8=0.125\)</span>).</p>
</div>
</div>
</div>
<p>Pour chaque état pathologique (<span class="math inline">\(S\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(I\)</span>
et <span class="math inline">\(R\)</span>) dans le groupe d’âge (<span class="math inline">\(i\)</span>), nous avons une équation
différentielle décrivant le taux de changement par rapport au temps.</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS_i}{dt} &amp; = - \beta S_i \sum_j C_{i,j} I_j/N_j \\
\frac{dE_i}{dt} &amp;= \beta S_i\sum_j C_{i,j} I_j/N_j - \alpha E_i \\
\frac{dI_i}{dt} &amp;= \alpha E_i - \gamma I_i \\
\frac{dR_i}{dt} &amp;=\gamma I_i \\
\end{aligned}
\]</span></p>
<p>Les individus de la tranche d’âge (<span class="math inline">\(i\)</span>) quittent l’état sensible (<span class="math inline">\(S_i\)</span>) pour l’état exposé (<span class="math inline">\(E_i\)</span>) par le biais de contacts spécifiques
à l’âge avec des individus infectieux dans tous les groupes <span class="math inline">\(\beta S_i \sum_j C_{i,j} I_j/N_j\)</span>. La
matrice de contact <span class="math inline">\(C\)</span> permet de
tenir compte de l’hétérogénéité des contacts entre les groupes d’âge.
Ils passent ensuite à l’état infectieux à un taux <span class="math inline">\(\alpha\)</span> et se rétablissent à un taux <span class="math inline">\(\gamma\)</span>. Notez que ce modèle suppose qu’il
n’y a pas de perte d’immunité (il n’y a pas de flux sortant de l’état de
guérison), ce qui peut ne pas être le cas pour toutes les maladies, car
certains individus guerris peuvent redevenir infectés à la suite de leur
guérison dans la cadre de certaines maladies.</p>
<p>Les paramètres du modèle sont les suivants</p>
<ul>
<li>taux de transmission <span class="math inline">\(\beta\)</span>
(dérivé du nombre de reproduction de base <span class="math inline">\(R_0\)</span> et du taux de guérison <span class="math inline">\(\gamma\)</span>),</li>
<li>
<a href="reference.html#contact">matrice de contact</a> <span class="math inline">\(C\)</span> contenant la fréquence des contacts
entre les groupes d’âge (une matrice carrée <span class="math inline">\(i \times j\)</span>),</li>
<li>le taux d’infectiosité <span class="math inline">\(\alpha\)</span>
(période pré-infectieuse, ou <a href="reference.html#latent">période de
latence</a> =<span class="math inline">\(1/\alpha\)</span>), et</li>
<li>taux de guérison <span class="math inline">\(\gamma\)</span>
(période infectieuse = <span class="math inline">\(1/\gamma\)</span>).</li>
</ul>
<div id="exposé-infecté-infectieux" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="exposé-infecté-infectieux" class="callout-inner">
<h3 class="callout-title">Exposé, infecté, infectieux</h3>
<div class="callout-content">
<p>Les termes “exposé”, “infecté” et “infectieux” dans la modélisation
mathématique prêtent parfois à confusion. L’infection se produit après
qu’une personne a été exposée, mais en termes de modélisation, les
individus “exposés” sont considérés comme déjà infectés.</p>
<p>Nous utiliserons les définitions suivantes pour nos variables d’état
:</p>
<ul>
<li>
<span class="math inline">\(E\)</span> = Exposé : infecté
<strong>mais pas encore</strong> infectieux,</li>
<li>
<span class="math inline">\(I\)</span> = infectieux : infecté
<strong>et</strong> infectieux.</li>
</ul>
</div>
</div>
</div>
<p>Pour générer des trajectoires à l’aide de notre modèle, nous devons
préparer les données d’entrée suivantes :</p>
<ol style="list-style-type: decimal">
<li>Matrice de contact</li>
<li>Conditions initiales</li>
<li>Structure de la population</li>
<li>Paramètres du modèle</li>
</ol>
<div class="section level3">
<h3 id="matrice-de-contact">1. Matrice de contact<a class="anchor" aria-label="anchor" href="#matrice-de-contact"></a>
</h3>
<p>Une matrice de contacts représente le nombre moyen de contacts entre
les individus de différents groupes d’âge. Il s’agit d’une composante
essentielle des modèles structurés par âge, car elle permet de savoir la
manière dont les différents groupes d’âge interagissent et se
transmettent potentiellement l’infections. Nous utiliserons le package R
<a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a> pour charger une matrice de contacts estimée à
partir des données de l’enquête POLYMOD <a href="https://doi.org/10.1371/journal.pmed.0050074" class="external-link">(Mossong et
al. 2008)</a>.</p>
<div id="charger-les-données-de-contact-et-de-démographie" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="charger-les-données-de-contact-et-de-démographie" class="callout-inner">
<h3 class="callout-title">Charger les données de contact et de démographie</h3>
<div class="callout-content">
<p>En utilisant la librairie <a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a>, obtenir la
matrice de contact du Royaume-Uni pour les tranches d’âge suivantes
:</p>
<ul>
<li>âge entre 0 et 20 ans,</li>
<li>âge compris entre 20 et 40 ans,</li>
<li>40 ans et plus.</li>
</ul>
<p>Utilisez le sondage disponible sur
<code>socialmixr::polymod</code>.</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Donner un indice </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<ul>
<li>Compléter le tutoriel sur <a href="contact-matrices.html">Matrices
de contact</a>.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Montrer la solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access the contact survey data</span></span>
<span><span class="va">polymod</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="va">polymod</span></span>
<span></span>
<span><span class="co"># Generate the contact matrix</span></span>
<span><span class="va">contact_data</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="fu">contact_matrix</span><span class="op">(</span></span>
<span>  <span class="va">polymod</span>,</span>
<span>  countries <span class="op">=</span> <span class="st">"United Kingdom"</span>,</span>
<span>  age.limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  symmetric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare contact matrix</span></span>
<span><span class="va">socialcontact_matrix</span> <span class="op">&lt;-</span> <span class="fu">t</span><span class="op">(</span><span class="va">contact_data</span><span class="op">$</span><span class="va">matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print</span></span>
<span><span class="va">socialcontact_matrix</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                 age.group
contact.age.group   [0,20)  [20,40)      40+
          [0,20)  7.883663 2.794154 1.565665
          [20,40) 3.120220 4.854839 2.624868
          40+     3.063895 4.599893 5.005571</code></pre>
</div>
<p>N’oubliez pas que la matrice satisfait à la condition
<code>symmetric = TRUE</code> au niveau du nombre total de contacts.</p>
<p>Le nombre total de contacts entre les groupes <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span> est calculé comme étant le nombre moyen
de contacts (<code>contact_data$matrix</code>) multiplié par le nombre
d’individus dans le groupe <span class="math inline">\(i\)</span>
(<code>contact_data$demography$population</code>).</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contact_data</span><span class="op">$</span><span class="va">matrix</span> <span class="op">*</span> <span class="va">contact_data</span><span class="op">$</span><span class="va">demography</span><span class="op">$</span><span class="va">population</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>         contact.age.group
age.group    [0,20)  [20,40)       40+
  [0,20)  116672620 46177038  45343471
  [20,40)  46177038 80232531  76019216
  40+      45343471 76019216 144967139</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Le résultat est une matrice carrée avec des lignes et des colonnes
pour chaque groupe d’âge. Les matrices de contact peuvent être chargées
à partir d’autres sources, mais elles doivent être formatées de sorte à
être utilisées par les fonctions de la librairies
<code>{epidemics}</code>.</p>
<div id="normalisation" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="normalisation" class="callout-inner">
<h3 class="callout-title">Normalisation</h3>
<div class="callout-content">
<p>Dans le cadre de <code>{epidemics}</code> la normalisation de la
matrice de contact se fait durant l’appel de la fonction, nous n’avons
donc pas besoin de normaliser la matrice de contact avant de la passer à
la fonction <code>epidemics::population()</code> (voir section 3.
Structure de la population). Pour plus de détails sur la normalisation,
consultez le tutoriel sur les <a href="%5BSimulation%20de%20la%20transmission%5D(../episodes/contact-matrices.md)">matrices
de contact</a> .</p>
</div>
</div>
</div>

</div>
<div class="section level3">
<h3 id="conditions-initiales">2. Conditions initiales<a class="anchor" aria-label="anchor" href="#conditions-initiales"></a>
</h3>
<p>Les conditions initiales sont la proportion d’individus dans chaque
état pathologique <span class="math inline">\(S\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(I\)</span>
et <span class="math inline">\(R\)</span> pour chaque groupe d’âge au
temps 0. Dans cet exemple, nous avons trois groupes d’âge : âge entre 0
et 20 ans, âge entre 20 et 40 ans et plus. Supposons que dans la
catégorie d’âge la plus jeune, un individu sur un million soit
infectieux, et que les autres catégories d’âge soient exemptes
d’infection.</p>
<p>Les conditions initiales dans la première catégorie d’âge sont les
suivantes <span class="math inline">\(S(0)=1-\frac{1}{1,000,000}\)</span>, <span class="math inline">\(E(0) =0\)</span>, <span class="math inline">\(I(0)=\frac{1}{1,000,000}\)</span>, <span class="math inline">\(R(0)=0\)</span>. Il est spécifié sous la forme
d’un vecteur comme suit :</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1 in 1,000,000 is equivalent to 1e-6</span></span>
<span><span class="va">initial_i</span> <span class="op">&lt;-</span> <span class="fl">1e-6</span></span>
<span><span class="va">initial_conditions_inf</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  S <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">initial_i</span>, E <span class="op">=</span> <span class="fl">0</span>, I <span class="op">=</span> <span class="va">initial_i</span>, R <span class="op">=</span> <span class="fl">0</span>, V <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Notez que R utilise la notation scientifique <code>e</code>, où
<code>e</code> vous indique de multiplier le nombre de base par 10 élevé
à la puissance indiquée (<a href="https://www.datakwery.com/post/2020-07-11-scientific-notation-in-r/" class="external-link">DataKwery,
2020</a>). L’expression <span class="math inline">\(1 \times
10^{-6}\)</span> équivaut à <code>1e-6</code>.</p>
<p>Pour les catégories d’âge exemptes d’infection, les conditions
initiales sont les suivantes <span class="math inline">\(S(0)=1\)</span>, <span class="math inline">\(E(0)
=0\)</span>, <span class="math inline">\(I(0)=0\)</span>, <span class="math inline">\(R(0)=0\)</span>. Nous spécifions ceci comme
suit,</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial_conditions_free</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  S <span class="op">=</span> <span class="fl">1</span>, E <span class="op">=</span> <span class="fl">0</span>, I <span class="op">=</span> <span class="fl">0</span>, R <span class="op">=</span> <span class="fl">0</span>, V <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Nous combinons les trois vecteurs de conditions initiales en une
seule matrice,</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combiner les conditions initiales dans un objet de classe matricielle</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span></span>
<span>  <span class="va">initial_conditions_inf</span>, <span class="co"># groupe d'age 1 (seul groupe infectieux)</span></span>
<span>  <span class="va">initial_conditions_free</span>, <span class="co"># groupe d'age 2</span></span>
<span>  <span class="va">initial_conditions_free</span> <span class="co"># groupe d'age 3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># utiliser la matrice de contact pour renommer les noms de lignes de la matrice</span></span>
<span><span class="co"># des conditions initiales</span></span>
<span><span class="fu">rownames</span><span class="op">(</span><span class="va">initial_conditions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">rownames</span><span class="op">(</span><span class="va">socialcontact_matrix</span><span class="op">)</span></span>
<span><span class="va">initial_conditions</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>               S E     I R V
[0,20)  0.999999 0 1e-06 0 0
[20,40) 1.000000 0 0e+00 0 0
40+     1.000000 0 0e+00 0 0</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="structure-de-la-population">3. Structure de la population<a class="anchor" aria-label="anchor" href="#structure-de-la-population"></a>
</h3>
<p>L’objet de la classe <population> nécessite un vecteur contenant la
structure démographique de la population. Le vecteur démographique doit
être un vecteur nommé contenant le nombre d’individus dans chaque groupe
d’âge de la population d’intéret. Dans cet exemple, nous pouvons
extraire les données démographiques du vecteur <code>contact_data</code>
que nous avons obtenu à l’aide de la librairie
<a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a>.</population></p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extraire le vecteur démographique</span></span>
<span><span class="va">demography_vector</span> <span class="op">&lt;-</span> <span class="va">contact_data</span><span class="op">$</span><span class="va">demography</span><span class="op">$</span><span class="va">population</span></span>
<span></span>
<span><span class="co"># utiliser la matrice de contact pour renommer les noms</span></span>
<span><span class="co"># des lignes du vecteur démographique</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">demography_vector</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">rownames</span><span class="op">(</span><span class="va">socialcontact_matrix</span><span class="op">)</span></span>
<span><span class="va">demography_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [0,20)  [20,40)      40+
14799290 16526302 28961159 </code></pre>
</div>
<p>Pour créer notre objet de classe <population> à partir de la
librairie <code>{epidemics}</code>, nous utiliserons la fonction
<code>epidemics::population()</code> en spécifiant le nom du pays, la
matrice de contact, le vecteur démographique et les conditions
initiales.</population></p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epidemics</span><span class="op">)</span></span>
<span></span>
<span><span class="va">uk_population</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">population</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"UK"</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="va">socialcontact_matrix</span>,</span>
<span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span>
<span>  initial_conditions <span class="op">=</span> <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span></code></pre>
</div>

</div>
<div class="section level3">
<h3 id="paramètres-du-modèle">4. Paramètres du modèle<a class="anchor" aria-label="anchor" href="#param%C3%A8tres-du-mod%C3%A8le"></a>
</h3>
<p>Pour exécuter notre modèle, nous devons spécifier les paramètres
:</p>
<ul>
<li>le taux de transmission <span class="math inline">\(\beta\)</span>,</li>
<li>taux d’infectiosité <span class="math inline">\(\alpha\)</span>
(période préinfectieuse=<span class="math inline">\(1/\alpha\)</span>),</li>
<li>taux de guérison <span class="math inline">\(\gamma\)</span>
(période infectieuse=<span class="math inline">\(1/\gamma\)</span>).</li>
</ul>
<p>Dans <code>{epidemics}</code> nous spécifions les paramètres du
modèle comme étant :</p>
<ul>
<li>
<code>transmission_rate</code> <span class="math inline">\(\beta =
R_0 \gamma\)</span>,</li>
<li>
<code>infectiousness_rate</code> = <span class="math inline">\(\alpha\)</span>,</li>
<li>
<code>recovery_rate</code> = <span class="math inline">\(\gamma\)</span>,</li>
</ul>
<p>Nous simulerons une souche de grippe à potentiel pandémique ayant les
caractéristiques suivantes <span class="math inline">\(R_0=1.46\)</span>
avec une période pré-infectieuse de 3 jours et une période infectieuse
de 7 jours. Nos données d’entrée seront donc les suivantes</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># les délais</span></span>
<span><span class="va">preinfectious_period</span> <span class="op">&lt;-</span> <span class="fl">3.0</span></span>
<span><span class="va">infectious_period</span> <span class="op">&lt;-</span> <span class="fl">7.0</span></span>
<span><span class="va">basic_reproduction</span> <span class="op">&lt;-</span> <span class="fl">1.46</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># les taux</span></span>
<span><span class="va">infectiousness_rate</span> <span class="op">&lt;-</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="va">preinfectious_period</span></span>
<span><span class="va">recovery_rate</span> <span class="op">&lt;-</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="va">infectious_period</span></span>
<span><span class="va">transmission_rate</span> <span class="op">&lt;-</span> <span class="va">basic_reproduction</span> <span class="op">/</span> <span class="va">infectious_period</span></span></code></pre>
</div>
<div id="le-nombre-de-reproduction-de-base-r_0" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="le-nombre-de-reproduction-de-base-r_0" class="callout-inner">
<h3 class="callout-title">Le nombre de reproduction de base <span class="math inline">\(R_0\)</span>
</h3>
<div class="callout-content">
<p>Le nombre de reproduction de base, <span class="math inline">\(R_0\)</span> pour le modèle SEIR est le suivant
:</p>
<p><span class="math display">\[ R_0 =
\frac{\beta}{\gamma}.\]</span></p>
<p>Par conséquent, nous pouvons réécrire le taux de transmission <span class="math inline">\(\beta\)</span> comme suit :</p>
<p><span class="math display">\[ \beta = R_0 \gamma.\]</span></p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="exécution-du-modèle">Exécution du modèle<a class="anchor" aria-label="anchor" href="#ex%C3%A9cution-du-mod%C3%A8le"></a>
</h2>
<hr class="half-width">
<div id="exécution-résolution-du-modèle" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="exécution-résolution-du-modèle" class="callout-inner">
<h3 class="callout-title">Exécution (résolution) du modèle</h3>
<div class="callout-content">
<p>Pour les modèles décrits par les <a href="reference.html#ordinary">équations différentielles</a>, “exécuter”
le modèle signifie en fait prendre le système d’équations
différentielles et le “résoudre” pour découvrir comment le nombre de
personnes dans les compartiments sous-jacents évolue dans le temps.
Étant donné que les équations différentielles décrivent le taux de
changement des états pathologiques en fonction du temps, plutôt que le
nombre d’individus dans chacun de ces états, nous devons généralement
utiliser des méthodes numériques pour résoudre les équations.</p>
<p>Un <em>solveur ODE</em> est le logiciel utilisé pour trouver des
solutions numériques aux équations différentielles. Si vous souhaitez
savoir comment un système d’équations différentielles est résolu dans
<code>{epidemics}</code> nous vous suggérons de lire la section sur <a href="https://epiverse-trace.github.io/epidemics/articles/design-principles.html#ode-systems-and-models" class="external-link">Systèmes
et modèles d’EDO</a> de la vignette “Design principles”.</p>
</div>
</div>
</div>
<p>Nous sommes maintenant prêts à exécuter notre modèle en utilisant
<code>epidemics::model_default()</code> de la librairies
<code>{epidemics}</code>.</p>
<p>Précisons <code>time_end=600</code> pour exécuter le modèle pendant
600 jours.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># les taux</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># duree de l'épidémie</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">600</span>,</span>
<span>  increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    time demography_group compartment    value
   &lt;num&gt;           &lt;char&gt;      &lt;char&gt;    &lt;num&gt;
1:     0           [0,20) susceptible 14799275
2:     0          [20,40) susceptible 16526302
3:     0              40+ susceptible 28961159
4:     0           [0,20)     exposed        0
5:     0          [20,40)     exposed        0
6:     0              40+     exposed        0</code></pre>
</div>
<p>Remarque : ce modèle permet également d’inclure la vaccination et de
suivre le nombre d’individus vaccinés au fil du temps. Même si nous
n’avons pas spécifié de vaccination, il y a toujours un compartiment
vacciné dans le résultat (ne contenant aucun individu). Nous aborderons
l’utilisation de la vaccination dans le prochain tutoriel.</p>
<p>Le résultat de notre modèle est le nombre d’individus dans chaque
compartiment de chaque groupe d’âge au cours du temps. Nous pouvons
visualiser uniquement les individus infectieux (ceux qui se trouvent
dans le compartiment <span class="math inline">\(I\)</span>) au cours du
temps.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time</span>,</span>
<span>      y <span class="op">=</span> <span class="va">value</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">demography_group</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Durée de la simulation (en jours)"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"Compartiment"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"nombre d'invidus"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/simulating-transmission-rendered-visualise-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="incréments-de-temps" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="incréments-de-temps" class="callout-inner">
<h3 class="callout-title">Incréments de temps</h3>
<div class="callout-content">
<p>Notez qu’il existe une valeur par défaut de l’argument
<code>increment = 1</code>. Il s’agit du pas de temps du solveur ODE.
Lorsque les paramètres sont spécifiés sur une échelle de temps
quotidienne et la limite de temps (<code>time_end</code>) est de jours,
le pas de temps par défaut du solveur ODE est d’un jour.</p>
<p>Le choix de l’incrément dépend de l’échelle de temps des paramètres
et de la vitesse à laquelle les événements peuvent se produire. En
général, l’incrément doit être plus petit que l’événement le plus rapide
qui puisse se produire. Par exemple, l’incrément doit être plus petit
que l’événement le plus rapide qui peut se produire :</p>
<ul>
<li>si les paramètres se situent sur une échelle de temps quotidienne et
que tous les événements sont signalés quotidiennement, l’incrément doit
être égal à un jour ;</li>
<li>si les paramètres se situent sur une échelle de temps mensuelle,
mais que certains événements se produisent au cours d’un mois,
l’incrément doit être inférieur à un mois.</li>
</ul>
</div>
</div>
</div>
<div id="testimonial1" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Témoignage</h3>
<div class="callout-content">
<p><strong>Deux fonctions d’aide dans
<code>{epidemics}</code></strong></p>
<p>Utilisez <code>epidemics::epidemic_peak()</code> pour obtenir l’heure
et la taille du pic le plus élevé d’un compartiment pour tous les
groupes démographiques. Par défaut, cela calculera pour le compartiment
infectieux.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epidemics</span><span class="fu">::</span><span class="fu">epidemic_peak</span><span class="op">(</span>data <span class="op">=</span> <span class="va">output</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   demography_group compartment  time    value
             &lt;char&gt;      &lt;char&gt; &lt;num&gt;    &lt;num&gt;
1:           [0,20)  infectious   315 651944.3
2:          [20,40)  infectious   319 625863.8
3:              40+  infectious   322 858259.1</code></pre>
</div>
<p>Utilisez <code>epidemics::epidemic_size()</code> pour obtenir la
taille de l’épidémie à n’importe quel stade entre le début et la fin.
Celle-ci est calculée comme le nombre d’individus <em>guéris</em> de
l’infection à ce stade de l’épidémie.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epidemics</span><span class="fu">::</span><span class="fu">epidemic_size</span><span class="op">(</span>data <span class="op">=</span> <span class="va">output</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  9285873  9040679 12540088</code></pre>
</div>
<p>Ces fonctions de synthèse peuvent vous aider à obtenir des résultats
pertinents pour comparer des scénarios ou pour toute autre analyse en
aval.</p>
</div>
</div>
</div>
<p>La figure ci-dessus montre le nombre total ou le nombre cumulé
d’individus dans le compartiment infectieux à chaque instant. Si vous
souhaitez montrer la <em>charge totale</em> de la maladie, le
compartiment <code>infectious</code> est le plus approprié. En revanche,
si vous souhaitez montrer la <em>charge quotidienne</em>, vous pouvez
utiliser <code>epidemics::new_infections()</code> pour obtenir
l’incidence quotidienne.</p>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Afficher les détails </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<p>Notez que le nombre de nouveaux cas infectés à chaque instant (comme
dans la figure ci-dessous) est inférieur au nombre cumulé de personnes
infectieuses à chaque instant (comme dans la figure ci-dessus).</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># New infections</span></span>
<span><span class="va">newinfections_bygroup</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">new_infections</span><span class="op">(</span>data <span class="op">=</span> <span class="va">output</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualise the spread of the epidemic in terms of new infections</span></span>
<span><span class="va">newinfections_bygroup</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">new_infections</span>, colour <span class="op">=</span> <span class="va">demography_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu">breaks_pretty</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/simulating-transmission-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>

</section><section><h2 class="section-heading" id="prise-en-compte-de-lincertitude">Prise en compte de l’incertitude<a class="anchor" aria-label="anchor" href="#prise-en-compte-de-lincertitude"></a>
</h2>
<hr class="half-width">
<p>Le modèle épidémique est <a href="reference.html#deterministic">déterministe</a>, c’est-à-dire qu’il
fonctionne comme une horloge : les mêmes paramètres conduiront toujours
à la même trajectoire. Un modèle déterministe est un modèle dont le
résultat est entièrement déterminé par les conditions et les paramètres
initiaux, sans aucune variation aléatoire. Cependant, la réalité n’est
pas aussi prévisible à cause de ces deux raisons principales : le
processus de transmission peut être aléatoire et nous pouvons ne pas
connaître les caractéristiques épidémiologiques exactes de l’agent
pathogène qui nous intéresse. Dans le prochain épisode, nous examinerons
les modèles “stochastiques” (c’est-à-dire les modèles dans lesquels nous
pouvons définir le processus qui crée un caractère aléatoire dans la
transmission). Entre-temps, nous pouvons inclure l’incertitude dans la
valeur des paramètres qui entrent dans le modèle déterministe. Pour
tenir compte de cette incertitude, nous devons exécuter notre modèle
pour différentes combinaisons de paramètres.</p>
<p>Nous avons exécuté notre modèle avec <span class="math inline">\(R_0
= 1.5\)</span>. Cependant, nous pensons que <span class="math inline">\(R_0\)</span> suit une distribution normale avec
une moyenne de 1,5 et un écart-type de 0,05. Pour tenir compte de
l’incertitude, nous exécuterons le modèle pour différentes valeurs de
<span class="math inline">\(R_0\)</span>. Les étapes à suivre pour ce
faire sont les suivantes :</p>
<ol style="list-style-type: decimal">
<li>Obtenir 100 valeurs aléatoires de <span class="math inline">\(R_0\)</span> à partir d’une distribution
normale.</li>
</ol>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># spécifier la moyenne et l'écart-type de R0</span></span>
<span><span class="va">r_estimate_mean</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">r_estimate_sd</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="co"># Générer 100 R0 de façon aléatoire</span></span>
<span><span class="va">r_samples</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu">with_seed</span><span class="op">(</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="fu">rnorm</span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">100</span>, mean <span class="op">=</span> <span class="va">r_estimate_mean</span>, sd <span class="op">=</span> <span class="va">r_estimate_sd</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">infectious_period</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">r_samples</span> <span class="op">/</span> <span class="va">infectious_period</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Exécutez le modèle 100 fois en variant <span class="math inline">\(R_0\)</span> à chaque itération</li>
</ol>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_samples</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">beta</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">600</span>,</span>
<span>  increment <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Calculez la moyenne et les quantiles à 95 % du nombre d’individus
infectieux pour chaque simulation du modèle et visualisez les
résultats.</li>
</ol>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_samples</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>r_value <span class="op">=</span> <span class="va">r_samples</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">r_value</span>, group <span class="op">=</span> <span class="va">param_set</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_fermenter</span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"RdBu"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"R"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">demography_group</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Durée de simulation (en jours)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Nombre d'individus"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/simulating-transmission-rendered-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Le choix des paramètres dans lesquels inclure l’incertitude dépend de
plusieurs facteurs : le degré d’information sur la valeur d’un
paramètre, par exemple la cohérence des estimations tirées de la
littérature ; la sensibilité des résultats du modèle aux changements de
valeur des paramètres ; et l’objectif de la tâche de modélisation. Voir
aussi <a href="https://doi.org/10.1016%2Fj.epidem.2021.100520" class="external-link">McCabe et
al. 2021</a> pour en savoir plus sur les différents types d’incertitude
dans la modélisation des maladies infectieuses.</p>
</section><section><h2 class="section-heading" id="résumé">Résumé<a class="anchor" aria-label="anchor" href="#r%C3%A9sum%C3%A9"></a>
</h2>
<hr class="half-width">
<p>Dans ce tutoriel, nous avons appris à simuler la propagation d’une
maladie à l’aide d’un modèle mathématique. Une fois qu’un modèle a été
choisi, les paramètres et autres données d’entrées doivent être
spécifiés de manière correcte pour effectuer les simulations du modèle.
Dans le prochain tutoriel, nous verrons comment choisir le modèle
approprié pour différentes tâches.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Points clés</h3>
<div class="callout-content">
<ul>
<li>Les trajectoires de la maladie peuvent être générées à l’aide du
package <code>{epidemics}</code> de R.</li>
<li>L’incertitude devrait être incluse dans les trajectoires du modèle
en utilisant une gamme de valeurs des paramètres du modèle.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-modelling-interventions"><p>Content from <a href="modelling-interventions.html">Modélisation des interventions</a></p>
<hr>
<p>Dernière mise à jour le 2025-11-18 |

        <a href="https://github.com/epiverse-trace/tutorials-late-fr/edit/main/episodes/modelling-interventions.Rmd" class="external-link">Modifier cette page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Afficher toutes les solutions " data-collapse="Cacher toutes les solutions "> Afficher toutes les solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Vue d'ensemble</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Comment étudier l’effet des interventions sur les trajectoires des
maladies ?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectifs</h3>
<ul>
<li>Ajoutez les interventions pharmaceutiques et non pharmaceutiques à
la liste des interventions de l’UE. <code>{epidemics}</code> modèle</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Pré-requis</h3>
<div class="callout-content">
<ul>
<li>Compléter le tutoriel sur <a href="simulating-transmission.html">La
simulation de la transmission</a>.</li>
</ul>
<p>Les apprenants doivent également se familiariser avec les dépendances
des concepts suivants avant de travailler sur ce tutoriel :</p>
<p><strong>Réponse à l’épidémie</strong> : <a href="https://www.cdc.gov/nonpharmaceutical-interventions/" class="external-link">Types
d’intervention</a>.</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Les modèles mathématiques peuvent être utilisés pour générer des
trajectoires de propagation de maladies dans le cadre de la mise en
œuvre d’interventions à différents stades d’une épidémie. Ces
trajectoires peuvent être utilisées pour prendre des décisions sur les
interventions à mettre en œuvre pour ralentir la propagation des
maladies.</p>
<p>Les interventions sont généralement incorporées dans les modèles
mathématiques en manipulant les valeurs des paramètres pertinents, par
exemple la réduction de la transmission, ou en introduisant un nouvel
état de la maladie, par exemple la classe vaccinée, où nous supposons
que les individus qui appartiennent à cette classe ne sont plus
susceptibles d’être infectés.</p>
<p>Dans ce tutoriel, nous apprendrons à utiliser les outils suivants
<code>{epidemics}</code> pour modéliser les interventions et l’accès aux
données de contact social avec <a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a>. Nous
utiliserons <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a>, <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> et le tuyau
<code>%&gt;%</code> pour relier certaines de leurs fonctions, alors
appelons aussi <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epidemics</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">socialmixr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>

</section><section><h2 class="section-heading" id="interventions-non-pharmaceutiques">Interventions non pharmaceutiques<a class="anchor" aria-label="anchor" href="#interventions-non-pharmaceutiques"></a>
</h2>
<hr class="half-width">
<p><a href="reference.html#NPIs">Interventions non pharmaceutiques</a>
Les interventions non pharmaceutiques (INP) sont des mesures mises en
place pour réduire la transmission qui n’incluent pas l’administration
de médicaments ou de vaccins. Les IPN visent à réduire les contacts
entre les personnes infectieuses et les personnes sensibles en fermant
les écoles et les lieux de travail et en prenant d’autres mesures pour
empêcher la propagation de la maladie, par exemple en se lavant les
mains et en portant des masques.</p>
<p>Nous étudierons l’effet des interventions sur une épidémie de
COVID-19 à l’aide d’un modèle SEIR (<code>model_default()</code> dans le
paquetage R <code>{epidemics}</code>). Le modèle SEIR divise la
population en quatre compartiments : Susceptible (S), Exposé (E),
Infectieux (I) et Rétabli (R). Nous définirons les paramètres suivants
pour notre modèle : <span class="math inline">\(R_0 = 2.7\)</span>
(nombre de reproduction de base), période de latence ou période
pré-infectieuse <span class="math inline">\(= 4\)</span> jours, et la
période infectieuse <span class="math inline">\(= 5.5\)</span> jours
(paramètres adaptés de <a href="https://doi.org/10.1016/S2468-2667(20)30133-X" class="external-link">Davies et
al. (2020)</a>). Nous adoptons une matrice de contact avec des tranches
d’âge 0-18, 18-65, 65 ans et plus en utilisant <a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a>
et supposons qu’un individu sur un million dans chaque groupe d’âge est
contagieux au début de l’épidémie.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polymod</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="va">polymod</span></span>
<span><span class="va">contact_data</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="fu">contact_matrix</span><span class="op">(</span></span>
<span>  <span class="va">polymod</span>,</span>
<span>  countries <span class="op">=</span> <span class="st">"United Kingdom"</span>,</span>
<span>  age.limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">65</span><span class="op">)</span>,</span>
<span>  symmetric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare contact matrix</span></span>
<span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="fu">t</span><span class="op">(</span><span class="va">contact_data</span><span class="op">$</span><span class="va">matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare the demography vector</span></span>
<span><span class="va">demography_vector</span> <span class="op">&lt;-</span> <span class="va">contact_data</span><span class="op">$</span><span class="va">demography</span><span class="op">$</span><span class="va">population</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">demography_vector</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">rownames</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># initial conditions: one in every 1 million is infected</span></span>
<span><span class="va">initial_i</span> <span class="op">&lt;-</span> <span class="fl">1e-6</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  S <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">initial_i</span>, E <span class="op">=</span> <span class="fl">0</span>, I <span class="op">=</span> <span class="va">initial_i</span>, R <span class="op">=</span> <span class="fl">0</span>, V <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># build for all age groups</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">rep</span><span class="op">(</span><span class="va">initial_conditions</span>, <span class="fu">dim</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">5</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">rownames</span><span class="op">(</span><span class="va">initial_conditions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">rownames</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare the population to model as affected by the epidemic</span></span>
<span><span class="va">uk_population</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">population</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"UK"</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span>
<span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span>
<span>  initial_conditions <span class="op">=</span> <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="effet-des-fermetures-décoles-sur-la-propagation-de-covid-19">Effet des fermetures d’écoles sur la propagation de COVID-19<a class="anchor" aria-label="anchor" href="#effet-des-fermetures-d%C3%A9coles-sur-la-propagation-de-covid-19"></a>
</h4>
<p>Le premier IPN que nous examinerons est l’effet des fermetures
d’écoles sur la réduction du nombre de personnes infectées par COVID-19
au fil du temps. Nous supposons qu’une fermeture d’école réduit la
fréquence des contacts au sein des différents groupes d’âge et entre
eux. Sur la base d’études empiriques, nous supposons que les fermetures
d’écoles réduiront de 50 % les contacts entre enfants d’âge scolaire
(0-15 ans) et entraîneront une faible réduction (1 %) des contacts entre
adultes (15 ans et plus).</p>
<p>Pour inclure une intervention dans notre modèle, nous devons créer un
<code>intervention</code> objet. Les données d’entrée sont le nom de
l’intervention (<code>name</code>), le type d’intervention
(<code>contacts</code> ou <code>rate</code>), l’heure de début
(<code>time_begin</code>), l’heure de fin (<code>time_end</code>) et la
réduction (<code>reduction</code>). Les valeurs de la matrice de
réduction sont spécifiées dans le même ordre que les groupes d’âge dans
la matrice de contact.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rownames</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "[0,15)"  "[15,65)" "65+"    </code></pre>
</div>
<p>Par conséquent, nous spécifions
<code>reduction = matrix(c(0.5, 0.01, 0.01))</code>. Nous supposons que
les fermetures d’écoles commencent le 50e jour et se poursuivent pendant
100 jours supplémentaires. Notre objet d’intervention est donc :</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">close_schools</span> <span class="op">&lt;-</span> <span class="fu">intervention</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"School closure"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"contacts"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">50</span> <span class="op">+</span> <span class="fl">100</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div id="effet-des-interventions-sur-les-contacts" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="effet-des-interventions-sur-les-contacts" class="callout-inner">
<h3 class="callout-title">Effet des interventions sur les contacts</h3>
<div class="callout-content">
<p>Dans le cadre de <code>{epidemics}</code> la matrice des contacts est
réduite par des proportions pour la période pendant laquelle
l’intervention est en place. Pour comprendre comment la réduction est
calculée dans les fonctions du modèle, considérons une matrice de
contacts pour deux groupes d’âge avec un nombre égal de contacts :</p>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2]
[1,]    1    1
[2,]    1    1</code></pre>
</div>
<p>Si la réduction est de 50 % dans le groupe 1 et de 10 % dans le
groupe 2, la matrice des contacts pendant l’intervention sera la
suivante :</p>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2]
[1,] 0.25 0.45
[2,] 0.45 0.81</code></pre>
</div>
<p>Les contacts au sein du groupe 1 sont réduits de 50 % deux fois pour
tenir compte d’une réduction de 50 % des contacts sortants et entrants
(<span class="math inline">\(1\times 0.5 \times 0.5 = 0.25\)</span>). De
même, les contacts au sein du groupe 2 sont réduits deux fois de 10 %.
Les contacts entre le groupe 1 et le groupe 2 sont réduits de 50 %, puis
de 10 % (<span class="math inline">\(1 \times 0.5 \times 0.9=
0.45\)</span>).</p>
</div>
</div>
</div>
<p>En utilisant le taux de transmission <span class="math inline">\(=
2.7/5.5\)</span> (rappelez-vous que <a href="simulating-transmission.html#the-basic-reproduction-number-r_0">taux
de transmission = <span class="math inline">\(R_0\)</span>/ période
infectieuse</a>), taux d’infectiosité <span class="math inline">\(1/=
4\)</span> et le taux de guérison <span class="math inline">\(=
1/5.5\)</span> nous exécutons le modèle avec
<code>intervention = list(contacts = close_schools)</code> comme suit
:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># time periods</span></span>
<span><span class="va">preinfectious_period</span> <span class="op">&lt;-</span> <span class="fl">4.0</span></span>
<span><span class="va">infectious_period</span> <span class="op">&lt;-</span> <span class="fl">5.5</span></span>
<span><span class="va">basic_reproduction</span> <span class="op">&lt;-</span> <span class="fl">2.7</span></span>
<span></span>
<span><span class="co"># rates</span></span>
<span><span class="va">infectiousness_rate</span> <span class="op">&lt;-</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="va">preinfectious_period</span></span>
<span><span class="va">recovery_rate</span> <span class="op">&lt;-</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="va">infectious_period</span></span>
<span><span class="va">transmission_rate</span> <span class="op">&lt;-</span> <span class="va">basic_reproduction</span> <span class="op">/</span> <span class="va">infectious_period</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_school</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># intervention</span></span>
<span>  intervention <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>contacts <span class="op">=</span> <span class="va">close_schools</span><span class="op">)</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">300</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Pour être en mesure de voir l’effet de notre intervention, nous
exécutons également une variante de base du modèle, c’est-à-dire sans
intervention, nous combinons les deux résultats dans un seul cadre de
données et nous traçons ensuite le résultat. Ici, nous représentons le
nombre total d’individus infectieux dans tous les groupes d’âge en
utilisant les données suivantes <code>ggplot2::stat_summary()</code>
fonction :</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run baseline simulation with no intervention</span></span>
<span><span class="va">output_baseline</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">300</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create intervention_type column for plotting</span></span>
<span><span class="va">output_school</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"school closure"</span></span>
<span><span class="va">output_baseline</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"baseline"</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">output_school</span>, <span class="va">output_baseline</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>,</span>
<span>    color <span class="op">=</span> <span class="va">intervention_type</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">intervention_type</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      <span class="va">close_schools</span><span class="op">$</span><span class="va">time_begin</span>,</span>
<span>      <span class="va">close_schools</span><span class="op">$</span><span class="va">time_end</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/modelling-interventions-rendered-baseline-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Nous pouvons constater qu’avec l’intervention en place, l’infection
se propage toujours dans la population et que l’accumulation de
l’immunité contribue à l’éventuel pic et déclin. Toutefois, le nombre
maximal de personnes infectées est inférieur (ligne pointillée verte) à
la ligne de base sans intervention (ligne continue rouge), ce qui montre
une réduction du nombre absolu de cas.</p>
</div>
<div class="section level4">
<h4 id="effet-du-port-du-masque-sur-la-propagation-de-covid-19">Effet du port du masque sur la propagation de COVID-19<a class="anchor" aria-label="anchor" href="#effet-du-port-du-masque-sur-la-propagation-de-covid-19"></a>
</h4>
<p>Nous pouvons également modéliser l’effet d’autres IPN en réduisant la
valeur des paramètres pertinents. Par exemple, étudier l’effet du port
du masque sur le nombre de personnes infectées par COVID-19 au fil du
temps.</p>
<p>Nous nous attendons à ce que le port d’un masque réduise la
contagiosité d’un individu, sur la base de nombreuses études montrant
l’efficacité des masques dans la réduction de la transmission. Comme
nous utilisons un modèle basé sur la population, nous ne pouvons pas
modifier les comportements individuels et nous supposons donc que le
taux de transmission <span class="math inline">\(\beta\)</span> est
réduit par une proportion due au port du masque dans la population. Nous
spécifions cette proportion, <span class="math inline">\(\theta\)</span>
comme le produit de la proportion de personnes portant un masque
multiplié par la proportion de réduction du taux de transmission (adapté
de <a href="https://doi.org/10.1371/journal.pone.0237691" class="external-link">Li et
al. 2020</a>).</p>
<p>Nous créons un objet d’intervention avec <code>type = rate</code> et
<code>reduction = 0.161</code>. En utilisant des paramètres adaptés de
<a href="https://doi.org/10.1371/journal.pone.0237691" class="external-link">Li et
al. 2020</a> nous avons la proportion de personnes portant des masques =
couverture <span class="math inline">\(\times\)</span> disponibilité =
<span class="math inline">\(0.54 \times 0.525 = 0.2835\)</span> et la
proportion de réduction du taux de transmission = <span class="math inline">\(0.575\)</span>. Par conséquent, <span class="math inline">\(\theta = 0.2835 \times 0.575 = 0.163\)</span>.
Nous supposons que l’obligation de porter un masque commence au 40e jour
et reste en vigueur pendant 200 jours.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mask_mandate</span> <span class="op">&lt;-</span> <span class="fu">intervention</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"mask mandate"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"rate"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">40</span> <span class="op">+</span> <span class="fl">200</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fl">0.163</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Pour mettre en œuvre cette intervention sur le taux de transmission
<span class="math inline">\(\beta\)</span> nous spécifions
<code>intervention = list(transmission_rate = mask_mandate)</code>.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_masks</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># intervention</span></span>
<span>  intervention <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>transmission_rate <span class="op">=</span> <span class="va">mask_mandate</span><span class="op">)</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">300</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create intervention_type column for plotting</span></span>
<span><span class="va">output_masks</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"mask mandate"</span></span>
<span><span class="va">output_baseline</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"baseline"</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">output_masks</span>, <span class="va">output_baseline</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>,</span>
<span>    color <span class="op">=</span> <span class="va">intervention_type</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">intervention_type</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      <span class="va">mask_mandate</span><span class="op">$</span><span class="va">time_begin</span>,</span>
<span>      <span class="va">mask_mandate</span><span class="op">$</span><span class="va">time_end</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/modelling-interventions-rendered-plot_masks-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="types-dintervention" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="types-dintervention" class="callout-inner">
<h3 class="callout-title">Types d’intervention</h3>
<div class="callout-content">
<p>Il existe deux types d’intervention pour
<code>model_default()</code>. Interventions sur les paramètres du modèle
(<code>transmission_rate</code> <span class="math inline">\(\beta\)</span>, <code>infectiousness_rate</code>
<span class="math inline">\(\sigma\)</span> et
<code>recovery_rate</code> <span class="math inline">\(\gamma\)</span>)
et les réductions des matrices de contact (<code>contacts</code>).</p>
<p>Pour mettre en œuvre les interventions sur les contacts et les taux
dans la même simulation, elles doivent être transmises sous la forme
d’une liste, par exemple,
<code>intervention = list(transmission_rate = mask_mandate, contacts = close_schools)</code>.
Toutefois, si plusieurs interventions ciblent les taux de contact, elles
doivent être transmises sous la forme d’une seule liste.
<code>contacts</code> entrée. Voir le <a href="https://epiverse-trace.github.io/epidemics/articles/modelling_multiple_interventions.html" class="external-link">vignette
sur la modélisation des interventions qui se chevauchent</a> pour plus
de détails.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="interventions-pharmaceutiques">Interventions pharmaceutiques<a class="anchor" aria-label="anchor" href="#interventions-pharmaceutiques"></a>
</h2>
<hr class="half-width">
<p>Les interventions pharmaceutiques (IP) sont des mesures telles que
les programmes de vaccination et de traitement de masse. Dans la section
précédente, nous avons intégré les interventions dans le modèle en
réduisant les valeurs des paramètres pendant une période spécifique de
la fenêtre temporelle au cours de laquelle ces interventions doivent
avoir lieu. Dans le cas de la vaccination, nous supposons qu’après
l’intervention, les individus ne sont plus sensibles et doivent être
classés dans un état pathologique différent. Par conséquent, nous
spécifions le taux auquel les individus sont vaccinés et suivons le
nombre d’individus vaccinés au fil du temps.</p>
<p>Le diagramme ci-dessous montre le modèle SEIRV mis en œuvre à l’aide
de <code>model_default()</code> où les individus sensibles sont vaccinés
et passent ensuite à l’étape de la vaccination. <span class="math inline">\(V\)</span> classe.</p>
<!--html_preserve-->
<div id="htmlwidget-c34b5edae5c64590a386" class="grViz html-widget html-fill-item" style="width:504px;height:504px;">

</div>
<script type="application/json" data-for="htmlwidget-c34b5edae5c64590a386">{"x":{"diagram":"digraph {\n\n  # graph statement\n  #################\n  graph [layout = dot,\n         rankdir = LR,\n         overlap = true,\n         fontsize = 10]\n\n  # nodes\n  #######\n  node [shape = square,\n       fixedsize = true\n       width = 1.3]\n\n       S\n       E\n       I\n       R\n       V\n\n  # edges\n  #######\n  S -> E [label = \" infection (&beta;)\"]\n  S -> V [label = \" vaccination (&nu;)\"]\n  E -> I [label = \" onset of \ninfectiousness (&alpha;)\"]\n  I -> R [label = \" recovery (&gamma;)\"]\n\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><!--/html_preserve--><p>Les équations décrivant ce modèle sont les suivantes :</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS_i}{dt} &amp; = - \beta S_i \sum_j C_{i,j} I_j/N_j -\nu_{t} S_i
\
\frac{dE_i}{dt} &amp;= \beta S_i\sum_j C_{i,j} I_j/N_j - \alpha E_i \
\frac{dI_i}{dt} &amp;= \alpha E_i - \gamma I_i \
\frac{dR_i}{dt} &amp;=\gamma I_i \
\frac{dV_i}{dt} &amp; =\nu_{i,t} S_i\
\end{aligned}
\]</span> Les individus de la tranche d’âge (<span class="math inline">\(i\)</span>) à un moment spécifique dépendant
(<span class="math inline">\(t\)</span>) sont vaccinés à un taux (<span class="math inline">\(\nu_{i,t}\)</span>). Les autres composantes SEIR
de ces équations sont décrites dans le tutoriel <a href="simulating-transmission.html#simulating-disease-spread">simuler la
transmission</a>.</p>
<p>Pour étudier l’effet de la vaccination, nous devons créer un objet de
vaccination que nous transmettrons en tant qu’entrée à la fonction
<code>model_default()</code> qui comprend le taux de vaccination
spécifique à chaque groupe d’âge <code>nu</code> et les heures de début
et de fin du programme de vaccination spécifiques aux groupes d’âge
(<code>time_begin</code> et <code>time_end</code>).</p>
<p>Nous supposerons ici que tous les groupes d’âge sont vaccinés au même
taux (0,01) et que le programme de vaccination commence au 40e jour et
se poursuit pendant 150 jours.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare a vaccination object</span></span>
<span><span class="va">vaccinate</span> <span class="op">&lt;-</span> <span class="fu">vaccination</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"vaccinate all"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">40</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">40</span> <span class="op">+</span> <span class="fl">150</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Nous passons notre objet de vaccination dans le modèle en utilisant
l’argument <code>vaccination = vaccinate</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_vaccinate</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># intervention</span></span>
<span>  vaccination <span class="op">=</span> <span class="va">vaccinate</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">300</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div id="comparez-les-interventions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="comparez-les-interventions" class="callout-inner">
<h3 class="callout-title">Comparez les interventions</h3>
<div class="callout-content">
<p>Représentez sur un même graphique les trois interventions
(vaccination, fermeture des écoles et obligation de porter un masque) et
la simulation de référence. Quelle intervention réduit le plus le nombre
maximal de personnes infectieuses ?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Montrer la solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create intervention_type column for plotting</span></span>
<span><span class="va">output_vaccinate</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"vaccination"</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">output_school</span>, <span class="va">output_masks</span>, <span class="va">output_vaccinate</span>, <span class="va">output_baseline</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>,</span>
<span>    color <span class="op">=</span> <span class="va">intervention_type</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">intervention_type</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/modelling-interventions-rendered-plot_vaccinate-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Le graphique montre que le pic du nombre total d’individus infectieux
en cas de vaccination est beaucoup plus faible que lors des fermetures
d’écoles et des interventions avec port de masques.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="résumé">Résumé<a class="anchor" aria-label="anchor" href="#r%C3%A9sum%C3%A9"></a>
</h2>
<hr class="half-width">
<p>Différents types d’intervention peuvent être mis en œuvre à l’aide de
la modélisation mathématique. La modélisation des interventions
nécessite des hypothèses sur les paramètres du modèle qui sont affectés
(par exemple, les matrices de contact, le taux de transmission), ainsi
que sur l’ampleur et le moment de la simulation d’une épidémie.</p>
<p>L’étape suivante consiste à quantifier l’effet d’une intervention. Si
vous souhaitez apprendre à comparer les interventions, veuillez suivre
le didacticiel suivant <a href="compare-interventions.html">Comparer les
résultats des interventions en matière de santé publique</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Points clés</h3>
<div class="callout-content">
<ul>
<li>L’effet des NPI peut être modélisé comme une réduction des taux de
contact entre les groupes d’âge ou une réduction du taux de transmission
de l’infection.</li>
<li>La vaccination peut être modélisée en supposant que les individus
passent à un état pathologique différent. <span class="math inline">\(V\)</span>
</li>
</ul>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="références">Références<a class="anchor" aria-label="anchor" href="#r%C3%A9f%C3%A9rences"></a>
</h2>
<hr class="half-width">
<ol style="list-style-type: decimal">
<li><p>Davies, N. G., Klepac, P., Liu, Y., Prem, K., Jit, M. et Eggo, R.
M. (2020). Age-dependent effects in the transmission and control of
COVID-19 epidemics (Effets dépendants de l’âge dans la transmission et
le contrôle des épidémies de COVID-19). Nature Medicine, 26(8),
1205-1211. <a href="https://doi.org/10.1016/S2468-2667%5C(20%5C)30133-X" class="external-link uri">https://doi.org/10.1016/S2468-2667\(20\)30133-X</a></p></li>
<li><p>Li, Y., Liang, M., Gao, L., Ahmed, M. A., Uy, J. P., Cheng, C., …
&amp; Sun, C. (2020). Masques de protection pour prévenir la
transmission du COVID-19 : A systematic review and meta-analysis.
American Journal of Infection Control, 49(7), 900-906. <a href="https://doi.org/10.1371/journal.pone.0237691" class="external-link uri">https://doi.org/10.1371/journal.pone.0237691</a></p></li>
<li><p>Mossong, J., Hens, N., Jit, M., Beutels, P., Auranen, K.,
Mikolajczyk, R., … &amp; Edmunds, W. J. (2008). Social contacts and
mixing patterns relevant to the spread of infectious diseases (contacts
sociaux et modèles de mélange pertinents pour la propagation des
maladies infectieuses). PLoS medicine, 5(3), e74. <a href="https://doi.org/10.1371/journal.pmed.0050074" class="external-link uri">https://doi.org/10.1371/journal.pmed.0050074</a></p></li>
</ol>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 --></section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>Cette leçon est soumise au <a href="CODE_OF_CONDUCT.html">Code de Conduite</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/tutorials-late-fr/edit/main/README.md" class="external-link">Modifier sur GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/tutorials-late-fr/blob/main/CONTRIBUTING.md" class="external-link">Contribuer</a>
        | <a href="https://github.com/epiverse-trace/tutorials-late-fr/" class="external-link">Code Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials-late-fr/blob/main/CITATION.cff" class="external-link">Citer</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">À propos</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Modèle publié sous licence <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> par <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Construit avec <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.13.9000)</a>, <a href="https://github.com/carpentries/pegboard/tree/7dc6acfdd6233c0d124a0ecf288325edc40dd96d" class="external-link">pegboard (0.7.9)</a>, et <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.7.9000)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Retour En Haut"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Retour</span> En Haut
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://epiverse-trace.github.io/tutorials-late-fr/aio.html",
  "inLanguage": "fr",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "epidemic models, interventions",
  "name": "Tout sur une seule page",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials-late-fr/aio.html",
  "identifier": "https://epiverse-trace.github.io/tutorials-late-fr/aio.html",
  "dateCreated": "2025-11-20",
  "dateModified": "2025-11-20",
  "datePublished": "2025-11-20"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

